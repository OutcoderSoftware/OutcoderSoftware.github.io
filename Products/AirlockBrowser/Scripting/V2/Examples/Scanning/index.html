<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>Airlock Browser Scripting - Barcode</title>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="../ScriptExamples.js"></script>
	<link rel="stylesheet" type="text/css" href="../ScriptExamples.css">
	<script>
		function HandleOnReader() {
			alert('On ready!');
		}

		//airlockState.onReady("HandleAirlockReady()");

		function HandleAirlockReady() {
			//alert('Doing stuff 2.');
			//var decoder = airlock.scanning.getDecoderWithName('Code39');
			//decoder.enabled = false;
			//airlock.scanning.setDecoder(decoder);
		}
	</script>
</head>
<body>
<div class="header">
	<div class="navigation"><a href="../" class="navigation">Airlock Browser Scripting</a></div>
	<h2>Scanning</h2>
</div>
<div id="dialog"><div id="dialogText" style="white-space: pre-wrap;"></div></div>

<div class="testDiv">
	<script>
		function TestDecoderProperties(textElement) {
			try {
				var codabarDecoder = airlock.scanning.getDecoderWithNativeId(71);
				codabarDecoder.enabled = true;
				codabarDecoder.notisEditingType = 1;
				codabarDecoder.lengthMin = 10;
				airlock.scanning.setDecoder(codabarDecoder);
				setText(textElement, "Decoder set");
			} catch (e) {
				setText(textElement, `Error ${e}`);
			}
		}
	</script>
	<input type="button" onclick="TestDecoderProperties('decoderPropertiesText')" value="Set decoder properties"/>
	<div class="outputText" id="decoderPropertiesText"></div>
</div>
<div class="testDiv">
	<script>
		function TestGetDecoderById(textElement) {
			try {
				var decoder = airlock.scanning.getDecoderWithNativeId(71);
				setText(textElement, `Decoder name: ${decoder.name}`);
			} catch (e) {
				setText(textElement, `Decoder get error ${e}`);
			}
		}
	</script>
	<input type="button" onclick="TestGetDecoderById('getDecoderByIdText')" value="Get decoder by ID"/>
	<div class="outputText" id="getDecoderByIdText"></div>
</div>
	<div class="testDiv">
	<script>
		function TestGetDecoders(textElement) {
			try {
				var promise = airlock.scanning.getDecoders();

				promise.then(function (decoders) {
					var text = getPropertyValues(decoders);
					showDialog(text);
				}).catch(function (error) {
					setText(textElement, `Error: ${error}`);
				});
			} catch (e) {
				setText(textElement, `Error: ${e}`);
			}
		}
	</script>
	<input type="button" onclick="TestGetDecoders('GetDecodersText')" value="Get all decoders"/>
	<div class="outputText" id="GetDecodersText"></div>
</div>
<div class="testDiv">
	<script>
		function TestSetConfiguration(textElement) {
			var config;
			try {
				config = airlock.scanning.getConfiguration();
				config.DisplayMode = true;
			} catch (e) {
				setText(textElement, "Configuration get error " + e);
				return;
			}

			try {
				airlock.scanning.setConfiguration(config);
			} catch (e) {
				setText(textElement, "Configuration set error " + e);
				return;
			}

			setText(textElement, "Configuration set");
		}
	</script>
	<input type="button" onclick="TestSetConfiguration('setConfigurationText')" value="Set Configuration"/>
	<div class="outputText" id="setConfigurationText"></div>
</div>
<div class="testDiv">
	<script>
		function TestGetDecoderWithName(textElement) {
			try {
				var decoder = airlock.scanning.getDecoderWithName('codabar');
				setText(textElement, decoder.name);
			} catch (e) {
				setText(textElement, `Error: ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestGetDecoderWithName('getDecoderWithNameText')" value="Get Decoder with Name"/>
	<div class="outputText" id="getDecoderWithNameText"></div>
</div>

<div class="testDiv">
	<script>
		function TestSetDecoder(textElement) {
			try {
				var decoder = airlock.scanning.getDecoderWithName('codabar');
				decoder.enabled = !decoder.enabled;
				airlock.scanning.setDecoder(decoder);
				setText(textElement, `${decoder.name}  enabled: ${decoder.enabled}`);
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestSetDecoder('setDecoderText')" value="Set Decoder"/>
	<div class="outputText" id="setDecoderText"></div>
</div>

<div class="testDiv">
	<script>
		function TestGetActive(textElement) {
			try {
				var active = airlock.scanning.isScannerActive();
				setText(textElement, active + "");
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestGetActive('getScannerActiveText')" value="Is Scanner Active"/>
	<div class="outputText" id="getScannerActiveText"></div>
</div>
<div class="testDiv">
	<script>
		function TestSetActive(textElement) {
			try {
				var active = airlock.scanning.getScannerActive();
				airlock.scanning.setScannerActive(!active);
				setText(textElement, 'Success');
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestSetActive('setScannerActiveText')" value="Set Scanner Active"/>
	<div class="outputText" id="setScannerActiveText"></div>
</div>
<div class="testDiv">
	<script>
		function TestGetReaderType(textElement) {
			try {
				var text = airlock.scanning.getReaderType();
				setText(textElement, text + "");
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestGetReaderType('getReaderTypeText')" value="Get Reader Type"/>
	<div class="outputText" id="getReaderTypeText"></div>
</div>
<div class="testDiv">
	<script>
		function TestGetScannerVersion(textElement) {
			try {
				var text = airlock.scanning.getScannerVersion();
				setText(textElement, text + "");
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestGetScannerVersion('getScannerVersionText')" value="Get Scanner Version"/>
	<div class="outputText" id="getScannerVersionText"></div>
</div>
<div class="testDiv">
	<script>
		function TestGetServiceVersion(textElement) {
			try {
				var text = airlock.scanning.getServiceVersion();
				setText(textElement, text + "");
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestGetServiceVersion('getServiceVersionText')" value="Get Service Version"/>
	<div class="outputText" type="text" id="getServiceVersionText"></div>
</div>

<div class="testDiv">
	<script>
		function TestSubscribeToScanEvent(textElement) {
			try {
				airlock.scanning.onScan.addListener(handleScan);
				setText(textElement, 'Subscribed.');
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}

		function handleScan(args) {
			setText('TestScanEventText', getPropertyValues(args));
		}

		function TestUnsubscribeToScanEvent(textElement) {
			try {
				airlock.scanning.onScan.removeListener(handleScan);
				setText(textElement, "Unsubscribed");
			} catch (e) {
				setText(textElement, `Error ${e}`);
				return;
			}
		}
	</script>
	<input type="button" onclick="TestSubscribeToScanEvent('TestScanEventText')" value="Subscribe to Scan Event"/><br/>
	<input type="button" onclick="TestUnsubscribeToScanEvent('TestScanEventText')" value="Unsubscribe"/><br/>
	<div class="outputText" type="text" id="TestScanEventText"></div>
</div>
	
<div class="testDiv">
	<script>
		function TestBeginScan(textElement) {
			try {
				airlock.scanning.beginScan();
				setText(textElement, "Begin scan...");
			} catch (e) {
				setText(textElement, `Error: ${e}`);
			}
		}
	</script>
	<input type="button" onclick="TestBeginScan('BeginScanText')" value="Begin Scan" />
	<div class="outputText" id="BeginScanText"></div>
</div>

</body>
</html>